mkdir -p ca
cd ca
mkdir certs crl newcerts private
#chmod 700 private
touch index.txt
echo 1000 > serial
echo 1000 > crlnumber

openssl genpkey -algorithm EC -out private/ca.key -aes256 -pkeyopt ec_paramgen_curve:secp384r1


openssl req -new -x509 -days 3650 -key private/ca.key -out certs/ca.crt -subj "/C=GB/ST=Company/L=Company/O=COM/OU=CloudMigration/CN=mTLS CA"

# CLIENT
openssl genpkey -algorithm EC -out private/client.key -aes256 -pkeyopt ec_paramgen_curve:secp384r1



openssl req -new -key private/client.key -out csr/client.csr -subj "/C=GB/ST=Company/L=Company/O=COM/OU=CloudMigration/CN=mTLS Client"


openssl ca -batch -in csr/client.csr -out certs/client.crt -days 365 -keyfile private/ca.key -cert certs/ca.crt -extensions usr_cert


# CRL

openssl ca -gencrl -out crl/ca.crl -keyfile private/ca.key -cert certs/ca.crt

openssl crl -inform PEM -text -noout -in crl/ca.crl

# DEV
openssl ca -gencrl -out mtls.crl -keyfile server.key -cert truststore.pem






curl https://sec.company.coom/api/v1/core/cards/ehi --key client.key --cert client.pem -i \
    -H "Accept: application/json" \
    -H "X-HTTP-Method-Override: POST" \
    -X POST -d "{
  "Acquirer_Country": "GBR",

  "Avl_Bal": 10001.0000,
  "Bill_Amt": 1.0000,

  "PIN": "0",
  "SendingAttemptCount": 0
}"
